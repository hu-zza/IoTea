openapi: 3.0.1
info:
  title: IoTea
  version: v0
servers:
- url: http://localhost:8080
  description: Generated server url
paths:
  /api/devices:
    get:
      tags:
      - Device Management
      operationId: getAllDevices
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DeviceOutput'
    post:
      tags:
      - Device Management
      operationId: postDevice
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/DeviceOutput'
  /api/devices/{identifier}:
    get:
      tags:
      - Device Management
      operationId: getDevicesByIdentifier
      parameters:
      - name: identifier
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DeviceOutput'
  /api/devices/id/{id}:
    get:
      tags:
      - Device Management
      operationId: getDeviceById
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/DeviceOutput'
    put:
      tags:
      - Device Management
      operationId: putDeviceToId
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/DeviceOutput'
    delete:
      tags:
      - Device Management
      operationId: deleteDeviceById
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        "204":
          description: No Content
  /api/devices/uid/{uid}:
    get:
      tags:
      - Device Management
      operationId: getDeviceByUid
      parameters:
      - name: uid
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/DeviceOutput'
    put:
      tags:
      - Device Management
      operationId: putDeviceToUid
      parameters:
      - name: uid
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/DeviceOutput'
    delete:
      tags:
      - Device Management
      operationId: deleteDeviceByUid
      parameters:
      - name: uid
        in: path
        required: true
        schema:
          type: string
      responses:
        "204":
          description: No Content
  /api/devices/name/{name}:
    get:
      tags:
      - Device Management
      operationId: getDeviceByName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/DeviceOutput'
    put:
      tags:
      - Device Management
      operationId: putDeviceToName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeviceInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/DeviceOutput'
    delete:
      tags:
      - Device Management
      operationId: deleteDeviceByName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "204":
          description: No Content
  /api/devices/ip/{ip}:
    get:
      tags:
      - Device Management
      operationId: getDevicesByIp
      parameters:
      - name: ip
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DeviceOutput'

  /api/commands:
    get:
      tags:
      - Command Management
      operationId: getAllCommands
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CommandOutput'
    post:
      tags:
      - Command Management
      operationId: postDevice_1
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommandInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/CommandOutput'
  /api/commands/{identifier}:
    get:
      tags:
      - Command Management
      operationId: getCommandsByIdentifier
      parameters:
      - name: identifier
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CommandOutput'
  /api/commands/id/{id}:
    get:
      tags:
      - Command Management
      operationId: getCommandById
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/CommandOutput'
    put:
      tags:
      - Command Management
      operationId: putDeviceToId_1
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommandInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/CommandOutput'
    delete:
      tags:
      - Command Management
      operationId: deleteCommandById
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        "204":
          description: No Content
  /api/commands/name/{name}:
    get:
      tags:
      - Command Management
      operationId: getCommandByName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/CommandOutput'
    put:
      tags:
      - Command Management
      operationId: putDeviceToName_1
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommandInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/CommandOutput'
    delete:
      tags:
      - Command Management
      operationId: deleteCommandByName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "204":
          description: No Content

  /api/jobs:
    get:
      tags:
      - Job Management
      operationId: getAllJobs_1
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/JobOutput'
    post:
      tags:
      - Job Management
      operationId: postJob
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JobInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
  /api/jobs/{identifier}:
    get:
      tags:
      - Job Management
      operationId: getJobsByIdentifier_1
      parameters:
      - name: identifier
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/JobOutput'
  /api/jobs/id/{id}:
    get:
      tags:
      - Job Management
      operationId: getJobById
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
    put:
      tags:
      - Job Management
      operationId: putJobToId
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JobInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
    post:
      tags:
      - Job Management
      operationId: runJobById
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JobContext'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
    delete:
      tags:
      - Job Management
      operationId: deleteJobById
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        "204":
          description: No Content
  /api/jobs/name/{name}:
    get:
      tags:
      - Job Management
      operationId: getJobByName_1
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
    put:
      tags:
      - Job Management
      operationId: putJobToName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JobInput'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
    post:
      tags:
      - Job Management
      operationId: runJobByName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JobContext'
        required: true
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
    delete:
      tags:
      - Job Management
      operationId: deleteJobByName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "204":
          description: No Content

  /api:
    get:
      tags:
      - LOLLful
      operationId: getAllJobs
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/JobOutput'
  /api/{identifier}:
    get:
      tags:
      - LOLLful
      operationId: getJobsByIdentifier
      parameters:
      - name: identifier
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/JobOutput'
  /api/id/{id}:
    get:
      tags:
      - LOLLful
      operationId: getJobById_1
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
  /api/name/{name}:
    get:
      tags:
      - LOLLful
      operationId: getJobByName
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
  /api/call/{id}/as/{name}:
    get:
      tags:
      - LOLLful
      operationId: setJobName
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int32
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
  /api/{deviceName}/{commandName}:
    get:
      tags:
      - LOLLful
      operationId: createJob
      parameters:
      - name: deviceName
        in: path
        required: true
        schema:
          type: string
      - name: commandName
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
  /api/{deviceName}/{commandName}/name/{jobName}:
    get:
      tags:
      - LOLLful
      operationId: createNamedJob
      parameters:
      - name: jobName
        in: path
        required: true
        schema:
          type: string
      - name: deviceName
        in: path
        required: true
        schema:
          type: string
      - name: commandName
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
  /api/run/{name}:
    get:
      tags:
      - LOLLful
      operationId: runJobByNameAlias
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
  /api/run/{name}/{parameters}:
    get:
      tags:
      - LOLLful
      operationId: runJobByNameAlias_1
      parameters:
      - name: name
        in: path
        required: true
        schema:
          type: string
      - name: parameters
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/JobOutput'
components:
  schemas:
    DeviceInput:
      required:
      - ip
      - name
      - port
      - uid
      type: object
      properties:
        uid:
          maxLength: 255
          minLength: 1
          type: string
        name:
          maxLength: 255
          minLength: 1
          type: string
        ip:
          maxLength: 255
          minLength: 1
          type: string
        port:
          maximum: 65535
          minimum: 0
          type: integer
          format: int32
    DeviceOutput:
      type: object
      properties:
        id:
          type: integer
          format: int32
        uid:
          type: string
        name:
          type: string
        address:
          $ref: '#/components/schemas/DeviceAddressOutput'
        port:
          type: integer
          format: int32
    DeviceAddressOutput:
      type: object
      properties:
        ip:
          type: string
        reachable:
          type: boolean

    CommandInput:
      required:
      - name
      - template
      type: object
      properties:
        name:
          maxLength: 255
          minLength: 1
          type: string
        template:
          maxLength: 30000
          minLength: 0
          type: string
        note:
          maxLength: 30000
          minLength: 0
          type: string
    CommandOutput:
      type: object
      properties:
        id:
          type: integer
          format: int32
        name:
          type: string
        template:
          type: string
        note:
          type: string

    JobInput:
      required:
      - command_id
      - device_id
      - name
      type: object
      properties:
        name:
          maxLength: 255
          minLength: 1
          type: string
        device_id:
          maximum: 2147483647
          minimum: 1
          type: integer
          format: int32
        command_id:
          maximum: 2147483647
          minimum: 1
          type: integer
          format: int32
    JobOutput:
      type: object
      properties:
        id:
          type: integer
          format: int32
        name:
          type: string
        device:
          $ref: '#/components/schemas/DeviceOutput'
        command:
          $ref: '#/components/schemas/CommandOutput'
        result:
          $ref: '#/components/schemas/Run'
    JobContext:
      type: object
      properties:
        parameters:
          type: array
          items:
            type: object
    Run:
      type: object
      properties:
        started:
          type: string
          format: date-time
        parameters:
          type: array
          items:
            type: object
        payload:
          type: string
        response:
          type: string
        raw_parameters:
          type: string
